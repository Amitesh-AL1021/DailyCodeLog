<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>DailyCodeLog – Amitesh</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-gray-800 px-6 py-4 max-w-4xl mx-auto">
  <header class="text-center mb-6">
    <a href="index.html"><h1 class="text-3xl font-bold text-blue-700">📘 Daily Code Log</h1></a>
    <p class="text-gray-600 mt-2">Tracking my daily DSA journey starting from <strong>14th July 2025</strong></p>
  </header>

  <section id="log-container">
    <h2 class="text-xl font-semibold mb-4">📅 Logs by Day</h2>
    <div id="loader" class="text-center text-gray-500">Loading...</div>
  </section>

  <script>
    const USERNAME = "Amitesh-AL1021";
    const REPO = "DailyCodeLog";
    const BRANCH = "main";
    const container = document.getElementById("log-container");
    const loader = document.getElementById("loader");

    async function fetchDayFolders() {
      const url = `https://api.github.com/repos/${USERNAME}/${REPO}/contents`;
      const res = await fetch(url);
      const data = await res.json();
      return data.filter(item => item.type === "dir" && item.name.startsWith("Day"));
    }

    async function fetchFiles(day) {
      const url = `https://api.github.com/repos/${USERNAME}/${REPO}/contents/${day}`;
      const res = await fetch(url);
      return res.json();
    }

    async function renderLog() {
      const days = await fetchDayFolders();
      days.sort((a, b) => {
        const n1 = parseInt(a.name.replace("Day", ""));
        const n2 = parseInt(b.name.replace("Day", ""));
        return n1 - n2;
      });

      container.innerHTML = ""; // Clear loader
      for (const day of days) {
        const files = await fetchFiles(day.name);
        const cppFiles = files.filter(f => f.name.endsWith(".cpp"));
        const mdFiles = files.filter(f => f.name.endsWith(".md"));

        const tableHTML = `
          <div class="mb-8">
            <h3 class="text-lg font-bold text-blue-600 mb-2">📘 ${day.name}</h3>
            <table class="table-auto w-full text-left border border-gray-300">
              <thead class="bg-gray-200">
                <tr>
                  <th class="px-4 py-2 border">📁 Filename</th>
                  <th class="px-4 py-2 border">🔗 Link</th>
                </tr>
              </thead>
              <tbody>
                ${[...cppFiles, ...mdFiles].map(file => `
                  <tr class="hover:bg-gray-50">
                    <td class="px-4 py-2 border">${file.name}</td>
                    <td class="px-4 py-2 border">
                      <a href="${file.html_url}" target="_blank" class="text-blue-600 underline">View</a>
                    </td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
        `;
        container.innerHTML += tableHTML;
      }
    }

    renderLog();
  </script>
</body>
</html>
